"""
Explainer Service - Generates human-readable explanations
"""
from typing import Dict, List, Any
from app.models.schemas import Language, ExplanationResponse

class Explainer:
    """Generates explanations for predictions in English and Hindi"""
    
    EXPLANATIONS = {
        "plant_disease": {
            "en": {
                "healthy": {
                    "why": "Your plant appears healthy with no visible signs of disease.",
                    "factors": [
                        "Good leaf color and texture",
                        "No visible spots or lesions",
                        "Proper growth pattern"
                    ],
                    "prevention": [
                        "Continue regular watering schedule",
                        "Maintain proper spacing between plants",
                        "Monitor regularly for early signs"
                    ],
                    "next_steps": [
                        "Keep monitoring weekly",
                        "Maintain current care routine",
                        "Consider preventive organic sprays"
                    ]
                },
                "disease": {
                    "why": "Disease detected based on visual symptoms like spots, discoloration, or abnormal growth.",
                    "factors": [
                        "Visible lesions or spots on leaves",
                        "Abnormal coloration",
                        "Possible fungal or bacterial infection"
                    ],
                    "prevention": [
                        "Remove affected leaves immediately",
                        "Improve air circulation",
                        "Avoid overhead watering",
                        "Apply appropriate fungicide/pesticide"
                    ],
                    "next_steps": [
                        "Isolate affected plants",
                        "Consult local agriculture officer",
                        "Apply recommended treatment",
                        "Monitor other plants"
                    ]
                }
            },
            "hi": {
                "healthy": {
                    "why": "рдЖрдкрдХрд╛ рдкреМрдзрд╛ рд╕реНрд╡рд╕реНрде рджрд┐рдЦ рд░рд╣рд╛ рд╣реИ рдФрд░ рдХреЛрдИ рдмреАрдорд╛рд░реА рдХреЗ рд▓рдХреНрд╖рдг рдирд╣реАрдВ рд╣реИрдВред",
                    "factors": [
                        "рдкрддреНрддрд┐рдпреЛрдВ рдХрд╛ рдЕрдЪреНрдЫрд╛ рд░рдВрдЧ рдФрд░ рдмрдирд╛рд╡рдЯ",
                        "рдХреЛрдИ рдзрдмреНрдмреЗ рдпрд╛ рдШрд╛рд╡ рдирд╣реАрдВ",
                        "рдЙрдЪрд┐рдд рд╡рд┐рдХрд╛рд╕ рдкреИрдЯрд░реНрди"
                    ],
                    "prevention": [
                        "рдирд┐рдпрдорд┐рдд рд╕рд┐рдВрдЪрд╛рдИ рдЬрд╛рд░реА рд░рдЦреЗрдВ",
                        "рдкреМрдзреЛрдВ рдХреЗ рдмреАрдЪ рдЙрдЪрд┐рдд рджреВрд░реА рдмрдирд╛рдП рд░рдЦреЗрдВ",
                        "рд╢реБрд░реБрдЖрддреА рд▓рдХреНрд╖рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдорд┐рдд рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ"
                    ],
                    "next_steps": [
                        "рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рдирд┐рдЧрд░рд╛рдиреА рдЬрд╛рд░реА рд░рдЦреЗрдВ",
                        "рд╡рд░реНрддрдорд╛рди рджреЗрдЦрднрд╛рд▓ рдЬрд╛рд░реА рд░рдЦреЗрдВ",
                        "рдирд┐рд╡рд╛рд░рдХ рдЬреИрд╡рд┐рдХ рд╕реНрдкреНрд░реЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"
                    ]
                },
                "disease": {
                    "why": "рджреГрд╢реНрдп рд▓рдХреНрд╖рдгреЛрдВ рдЬреИрд╕реЗ рдзрдмреНрдмреЗ, рд░рдВрдЧ рдмрджрд▓рд╛рд╡ рдпрд╛ рдЕрд╕рд╛рдорд╛рдиреНрдп рд╡реГрджреНрдзрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд░реЛрдЧ рдХрд╛ рдкрддрд╛ рдЪрд▓рд╛ред",
                    "factors": [
                        "рдкрддреНрддрд┐рдпреЛрдВ рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдШрд╛рд╡ рдпрд╛ рдзрдмреНрдмреЗ",
                        "рдЕрд╕рд╛рдорд╛рдиреНрдп рд░рдВрдЧрдд",
                        "рд╕рдВрднрд╛рд╡рд┐рдд рдХрд╡рдХ рдпрд╛ рдЬреАрд╡рд╛рдгреБ рд╕рдВрдХреНрд░рдордг"
                    ],
                    "prevention": [
                        "рдкреНрд░рднрд╛рд╡рд┐рдд рдкрддреНрддрд┐рдпреЛрдВ рдХреЛ рддреБрд░рдВрдд рд╣рдЯрд╛рдПрдВ",
                        "рд╣рд╡рд╛ рдХрд╛ рд╕рдВрдЪрд╛рд░ рдмреЗрд╣рддрд░ рдХрд░реЗрдВ",
                        "рдКрдкрд░ рд╕реЗ рдкрд╛рдиреА рджреЗрдиреЗ рд╕реЗ рдмрдЪреЗрдВ",
                        "рдЙрдЪрд┐рдд рдлрдлреВрдВрджрдирд╛рд╢рдХ/рдХреАрдЯрдирд╛рд╢рдХ рд▓рдЧрд╛рдПрдВ"
                    ],
                    "next_steps": [
                        "рдкреНрд░рднрд╛рд╡рд┐рдд рдкреМрдзреЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░реЗрдВ",
                        "рд╕реНрдерд╛рдиреАрдп рдХреГрд╖рд┐ рдЕрдзрд┐рдХрд╛рд░реА рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ рд▓реЗрдВ",
                        "рдЕрдиреБрд╢рдВрд╕рд┐рдд рдЙрдкрдЪрд╛рд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВ",
                        "рдЕрдиреНрдп рдкреМрдзреЛрдВ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ"
                    ]
                }
            }
        },
        "soil_type": {
            "en": {
                "clay": {
                    "why": "Soil identified as clay type based on texture and color analysis.",
                    "factors": [
                        "Dense, heavy texture",
                        "Retains water well",
                        "Rich in nutrients but poor drainage"
                    ],
                    "prevention": [
                        "Add organic matter to improve structure",
                        "Avoid working when wet",
                        "Consider raised beds for better drainage"
                    ],
                    "next_steps": [
                        "Test soil pH and nutrients",
                        "Add compost or sand to improve texture",
                        "Choose crops suitable for clay soil"
                    ]
                },
                "sandy": {
                    "why": "Soil identified as sandy type based on loose texture and light color.",
                    "factors": [
                        "Loose, gritty texture",
                        "Drains quickly",
                        "Low nutrient retention"
                    ],
                    "prevention": [
                        "Add organic matter regularly",
                        "Use mulch to retain moisture",
                        "Apply fertilizers in small, frequent doses"
                    ],
                    "next_steps": [
                        "Increase organic content",
                        "Consider drip irrigation",
                        "Choose drought-tolerant crops"
                    ]
                },
                "loamy": {
                    "why": "Soil identified as loamy - ideal for most crops.",
                    "factors": [
                        "Balanced texture",
                        "Good drainage and retention",
                        "Rich in nutrients"
                    ],
                    "prevention": [
                        "Maintain organic matter levels",
                        "Practice crop rotation",
                        "Avoid over-tilling"
                    ],
                    "next_steps": [
                        "Conduct regular soil tests",
                        "Most crops will thrive",
                        "Maintain current soil health"
                    ]
                }
            },
            "hi": {
                "clay": {
                    "why": "рдорд┐рдЯреНрдЯреА рдХреЛ рдмрдирд╛рд╡рдЯ рдФрд░ рд░рдВрдЧ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЪрд┐рдХрдиреА рдорд┐рдЯреНрдЯреА рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ред",
                    "factors": [
                        "рдШрдиреА, рднрд╛рд░реА рдмрдирд╛рд╡рдЯ",
                        "рдкрд╛рдиреА рдЕрдЪреНрдЫреА рддрд░рд╣ рд░реЛрдХрддреА рд╣реИ",
                        "рдкреЛрд╖рдХ рддрддреНрд╡реЛрдВ рд╕реЗ рднрд░рдкреВрд░ рд▓реЗрдХрд┐рди рдЬрд▓ рдирд┐рдХрд╛рд╕реА рдХрдо"
                    ],
                    "prevention": [
                        "рд╕рдВрд░рдЪрдирд╛ рд╕реБрдзрд╛рд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреИрд╡рд┐рдХ рдкрджрд╛рд░реНрде рдорд┐рд▓рд╛рдПрдВ",
                        "рдЧреАрд▓реА рд╣реЛрдиреЗ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рд╕реЗ рдмрдЪреЗрдВ",
                        "рдмреЗрд╣рддрд░ рдЬрд▓ рдирд┐рдХрд╛рд╕реА рдХреЗ рд▓рд┐рдП рдЙрдареА рд╣реБрдИ рдХреНрдпрд╛рд░рд┐рдпрд╛рдВ рдмрдирд╛рдПрдВ"
                    ],
                    "next_steps": [
                        "рдорд┐рдЯреНрдЯреА рдХрд╛ pH рдФрд░ рдкреЛрд╖рдХ рддрддреНрд╡ рдЬрд╛рдВрдЪреЗрдВ",
                        "рдмрдирд╛рд╡рдЯ рд╕реБрдзрд╛рд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдВрдкреЛрд╕реНрдЯ рдпрд╛ рд░реЗрдд рдорд┐рд▓рд╛рдПрдВ",
                        "рдЪрд┐рдХрдиреА рдорд┐рдЯреНрдЯреА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдлрд╕рд▓реЗрдВ рдЪреБрдиреЗрдВ"
                    ]
                },
                "sandy": {
                    "why": "рдвреАрд▓реА рдмрдирд╛рд╡рдЯ рдФрд░ рд╣рд▓реНрдХреЗ рд░рдВрдЧ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдорд┐рдЯреНрдЯреА рдХреЛ рд░реЗрддреАрд▓реА рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ред",
                    "factors": [
                        "рдвреАрд▓реА, рджрд╛рдиреЗрджрд╛рд░ рдмрдирд╛рд╡рдЯ",
                        "рдЬрд▓реНрджреА рд╕реВрдЦ рдЬрд╛рддреА рд╣реИ",
                        "рдХрдо рдкреЛрд╖рдХ рддрддреНрд╡ рд░реЛрдХрддреА рд╣реИ"
                    ],
                    "prevention": [
                        "рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЬреИрд╡рд┐рдХ рдкрджрд╛рд░реНрде рдорд┐рд▓рд╛рдПрдВ",
                        "рдирдореА рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдорд▓реНрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ",
                        "рдЫреЛрдЯреА, рдмрд╛рд░-рдмрд╛рд░ рдЦреБрд░рд╛рдХ рдореЗрдВ рдЙрд░реНрд╡рд░рдХ рдбрд╛рд▓реЗрдВ"
                    ],
                    "next_steps": [
                        "рдЬреИрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА рдмрдврд╝рд╛рдПрдВ",
                        "рдбреНрд░рд┐рдк рд╕рд┐рдВрдЪрд╛рдИ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ",
                        "рд╕реВрдЦрд╛-рд╕рд╣рд┐рд╖реНрдгреБ рдлрд╕рд▓реЗрдВ рдЪреБрдиреЗрдВ"
                    ]
                },
                "loamy": {
                    "why": "рдорд┐рдЯреНрдЯреА рдХреЛ рджреЛрдордЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ - рдЕрдзрд┐рдХрд╛рдВрд╢ рдлрд╕рд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ред",
                    "factors": [
                        "рд╕рдВрддреБрд▓рд┐рдд рдмрдирд╛рд╡рдЯ",
                        "рдЕрдЪреНрдЫреА рдЬрд▓ рдирд┐рдХрд╛рд╕реА рдФрд░ рд░реЛрдХрдиреЗ рдХреА рдХреНрд╖рдорддрд╛",
                        "рдкреЛрд╖рдХ рддрддреНрд╡реЛрдВ рд╕реЗ рднрд░рдкреВрд░"
                    ],
                    "prevention": [
                        "рдЬреИрд╡рд┐рдХ рдкрджрд╛рд░реНрде рдХрд╛ рд╕реНрддрд░ рдмрдирд╛рдП рд░рдЦреЗрдВ",
                        "рдлрд╕рд▓ рдЪрдХреНрд░ рдЕрдкрдирд╛рдПрдВ",
                        "рдЕрддреНрдпрдзрд┐рдХ рдЬреБрддрд╛рдИ рд╕реЗ рдмрдЪреЗрдВ"
                    ],
                    "next_steps": [
                        "рдирд┐рдпрдорд┐рдд рдорд┐рдЯреНрдЯреА рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВ",
                        "рдЕрдзрд┐рдХрд╛рдВрд╢ рдлрд╕рд▓реЗрдВ рдЕрдЪреНрдЫреА рд╣реЛрдВрдЧреА",
                        "рд╡рд░реНрддрдорд╛рди рдорд┐рдЯреНрдЯреА рд╕реНрд╡рд╛рд╕реНрдереНрдп рдмрдирд╛рдП рд░рдЦреЗрдВ"
                    ]
                }
            }
        },
        "aqi": {
            "en": {
                "good": {
                    "why": "Air quality is good. Safe for all outdoor agricultural activities.",
                    "factors": ["Low pollutant levels", "Good visibility", "Safe for crop growth"],
                    "prevention": ["Maintain green cover", "Avoid burning crop residue"],
                    "next_steps": ["Continue normal activities", "Good time for spraying"]
                },
                "moderate": {
                    "why": "Air quality is moderate. Some sensitive crops may be affected.",
                    "factors": ["Moderate pollution levels", "May affect sensitive plants"],
                    "prevention": ["Avoid spraying during peak hours", "Water plants to reduce dust"],
                    "next_steps": ["Monitor plant health", "Consider protective measures"]
                },
                "poor": {
                    "why": "Air quality is poor. May affect crop health and yield.",
                    "factors": ["High pollutant levels", "Reduced photosynthesis", "Stress on plants"],
                    "prevention": ["Delay spraying activities", "Use protective covers if possible"],
                    "next_steps": ["Wait for improvement", "Wash plant leaves", "Consult expert"]
                }
            },
            "hi": {
                "good": {
                    "why": "рд╡рд╛рдпреБ рдЧреБрдгрд╡рддреНрддрд╛ рдЕрдЪреНрдЫреА рд╣реИред рд╕рднреА рдмрд╛рд╣рд░реА рдХреГрд╖рд┐ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рддред",
                    "factors": ["рдкреНрд░рджреВрд╖рдХ рд╕реНрддрд░ рдХрдо", "рдЕрдЪреНрдЫреА рджреГрд╢реНрдпрддрд╛", "рдлрд╕рд▓ рд╡реГрджреНрдзрд┐ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рдд"],
                    "prevention": ["рд╣рд░рд┐рдд рдЖрд╡рд░рдг рдмрдирд╛рдП рд░рдЦреЗрдВ", "рдлрд╕рд▓ рдЕрд╡рд╢реЗрд╖ рдЬрд▓рд╛рдиреЗ рд╕реЗ рдмрдЪреЗрдВ"],
                    "next_steps": ["рд╕рд╛рдорд╛рдиреНрдп рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдВ рдЬрд╛рд░реА рд░рдЦреЗрдВ", "рдЫрд┐рдбрд╝рдХрд╛рд╡ рдХреЗ рд▓рд┐рдП рдЕрдЪреНрдЫрд╛ рд╕рдордп"]
                },
                "moderate": {
                    "why": "рд╡рд╛рдпреБ рдЧреБрдгрд╡рддреНрддрд╛ рдордзреНрдпрдо рд╣реИред рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╕рд▓реЗрдВ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВред",
                    "factors": ["рдордзреНрдпрдо рдкреНрд░рджреВрд╖рдг рд╕реНрддрд░", "рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдкреМрдзреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ"],
                    "prevention": ["рдкреАрдХ рдШрдВрдЯреЛрдВ рдореЗрдВ рдЫрд┐рдбрд╝рдХрд╛рд╡ рд╕реЗ рдмрдЪреЗрдВ", "рдзреВрд▓ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреМрдзреЛрдВ рдХреЛ рдкрд╛рдиреА рджреЗрдВ"],
                    "next_steps": ["рдкреМрдзреЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдкрд░ рдирдЬрд░ рд░рдЦреЗрдВ", "рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рдЙрдкрд╛рдп рдХрд░реЗрдВ"]
                },
                "poor": {
                    "why": "рд╡рд╛рдпреБ рдЧреБрдгрд╡рддреНрддрд╛ рдЦрд░рд╛рдм рд╣реИред рдлрд╕рд▓ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдФрд░ рдЙрдкрдЬ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИред",
                    "factors": ["рдЙрдЪреНрдЪ рдкреНрд░рджреВрд╖рдХ рд╕реНрддрд░", "рдкреНрд░рдХрд╛рд╢ рд╕рдВрд╢реНрд▓реЗрд╖рдг рдХрдо", "рдкреМрдзреЛрдВ рдкрд░ рддрдирд╛рд╡"],
                    "prevention": ["рдЫрд┐рдбрд╝рдХрд╛рд╡ рдореЗрдВ рджреЗрд░реА рдХрд░реЗрдВ", "рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рдЖрд╡рд░рдг рд▓рдЧрд╛рдПрдВ"],
                    "next_steps": ["рд╕реБрдзрд╛рд░ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ", "рдкреМрдзреЛрдВ рдХреА рдкрддреНрддрд┐рдпрд╛рдВ рдзреЛрдПрдВ", "рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ рд▓реЗрдВ"]
                }
            }
        },
        "crop_recommendation": {
            "en": {
                "why": "Based on soil nutrients, climate conditions, and your location.",
                "factors": [
                    "Nitrogen, Phosphorus, Potassium levels",
                    "Temperature and humidity",
                    "Soil pH and rainfall patterns"
                ],
                "prevention": [
                    "Prepare soil according to recommended crop",
                    "Ensure proper irrigation setup",
                    "Get quality seeds from certified sources"
                ],
                "next_steps": [
                    "Test soil before planting",
                    "Prepare land and irrigation",
                    "Consult local agriculture office for subsidies"
                ]
            },
            "hi": {
                "why": "рдорд┐рдЯреНрдЯреА рдХреЗ рдкреЛрд╖рдХ рддрддреНрд╡реЛрдВ, рдЬрд▓рд╡рд╛рдпреБ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдФрд░ рдЖрдкрдХреЗ рд╕реНрдерд╛рди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред",
                "factors": [
                    "рдирд╛рдЗрдЯреНрд░реЛрдЬрди, рдлрд╛рд╕реНрдлреЛрд░рд╕, рдкреЛрдЯреЗрд╢рд┐рдпрдо рд╕реНрддрд░",
                    "рддрд╛рдкрдорд╛рди рдФрд░ рдЖрд░реНрджреНрд░рддрд╛",
                    "рдорд┐рдЯреНрдЯреА рдХрд╛ pH рдФрд░ рд╡рд░реНрд╖рд╛ рдкреИрдЯрд░реНрди"
                ],
                "prevention": [
                    "рдЕрдиреБрд╢рдВрд╕рд┐рдд рдлрд╕рд▓ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдорд┐рдЯреНрдЯреА рддреИрдпрд╛рд░ рдХрд░реЗрдВ",
                    "рдЙрдЪрд┐рдд рд╕рд┐рдВрдЪрд╛рдИ рд╡реНрдпрд╡рд╕реНрдерд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ",
                    "рдкреНрд░рдорд╛рдгрд┐рдд рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рдЧреБрдгрд╡рддреНрддрд╛ рд╡рд╛рд▓реЗ рдмреАрдЬ рд▓реЗрдВ"
                ],
                "next_steps": [
                    "рдмреБрд╡рд╛рдИ рд╕реЗ рдкрд╣рд▓реЗ рдорд┐рдЯреНрдЯреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ",
                    "рднреВрдорд┐ рдФрд░ рд╕рд┐рдВрдЪрд╛рдИ рддреИрдпрд╛рд░ рдХрд░реЗрдВ",
                    "рд╕рдмреНрд╕рд┐рдбреА рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рдХреГрд╖рд┐ рдХрд╛рд░реНрдпрд╛рд▓рдп рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ рдХрд░реЗрдВ"
                ]
            }
        },
        "flood": {
            "en": {
                "high": {
                    "why": "High flood risk based on rainfall, river levels, and historical data.",
                    "factors": ["Heavy rainfall predicted", "River level rising", "Low elevation area"],
                    "prevention": ["Move livestock to higher ground", "Harvest ready crops immediately", "Prepare drainage channels"],
                    "next_steps": ["Create emergency crop storage", "Alert family and neighbors", "Keep emergency supplies ready"]
                },
                "moderate": {
                    "why": "Moderate flood risk. Stay vigilant and prepared.",
                    "factors": ["Above normal rainfall", "Some waterlogging expected"],
                    "prevention": ["Clear drainage channels", "Prepare protective barriers"],
                    "next_steps": ["Monitor weather updates", "Have backup plan ready"]
                },
                "low": {
                    "why": "Low flood risk based on current conditions.",
                    "factors": ["Normal rainfall levels", "Good drainage in area"],
                    "prevention": ["Maintain drainage systems", "Monitor weather regularly"],
                    "next_steps": ["Continue normal activities", "Stay informed"]
                }
            },
            "hi": {
                "high": {
                    "why": "рд╡рд░реНрд╖рд╛, рдирджреА рд╕реНрддрд░ рдФрд░ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрдЪреНрдЪ рдмрд╛рдврд╝ рдЬреЛрдЦрд┐рдоред",
                    "factors": ["рднрд╛рд░реА рд╡рд░реНрд╖рд╛ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА", "рдирджреА рдХрд╛ рд╕реНрддрд░ рдмрдврд╝ рд░рд╣рд╛ рд╣реИ", "рдирд┐рдЪрд▓рд╛ рдХреНрд╖реЗрддреНрд░"],
                    "prevention": ["рдкрд╢реБрдУрдВ рдХреЛ рдКрдВрдЪреЗ рд╕реНрдерд╛рди рдкрд░ рд▓реЗ рдЬрд╛рдПрдВ", "рддреИрдпрд╛рд░ рдлрд╕рд▓реЛрдВ рдХреА рддреБрд░рдВрдд рдХрдЯрд╛рдИ рдХрд░реЗрдВ", "рдЬрд▓ рдирд┐рдХрд╛рд╕реА рдЪреИрдирд▓ рддреИрдпрд╛рд░ рдХрд░реЗрдВ"],
                    "next_steps": ["рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдлрд╕рд▓ рднрдВрдбрд╛рд░рдг рдмрдирд╛рдПрдВ", "рдкрд░рд┐рд╡рд╛рд░ рдФрд░ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЛ рд╕рдЪреЗрдд рдХрд░реЗрдВ", "рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдЖрдкреВрд░реНрддрд┐ рддреИрдпрд╛рд░ рд░рдЦреЗрдВ"]
                },
                "moderate": {
                    "why": "рдордзреНрдпрдо рдмрд╛рдврд╝ рдЬреЛрдЦрд┐рдоред рд╕рддрд░реНрдХ рдФрд░ рддреИрдпрд╛рд░ рд░рд╣реЗрдВред",
                    "factors": ["рд╕рд╛рдорд╛рдиреНрдп рд╕реЗ рдЕрдзрд┐рдХ рд╡рд░реНрд╖рд╛", "рдХреБрдЫ рдЬрд▓рднрд░рд╛рд╡ рдХреА рд╕рдВрднрд╛рд╡рдирд╛"],
                    "prevention": ["рдЬрд▓ рдирд┐рдХрд╛рд╕реА рдЪреИрдирд▓ рд╕рд╛рдл рдХрд░реЗрдВ", "рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рдмрд╛рдзрд╛рдПрдВ рддреИрдпрд╛рд░ рдХрд░реЗрдВ"],
                    "next_steps": ["рдореМрд╕рдо рдЕрдкрдбреЗрдЯ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ", "рдмреИрдХрдЕрдк рдпреЛрдЬрдирд╛ рддреИрдпрд╛рд░ рд░рдЦреЗрдВ"]
                },
                "low": {
                    "why": "рд╡рд░реНрддрдорд╛рди рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдмрд╛рдврд╝ рдХрд╛ рдЬреЛрдЦрд┐рдо рдХрдо рд╣реИред",
                    "factors": ["рд╕рд╛рдорд╛рдиреНрдп рд╡рд░реНрд╖рд╛ рд╕реНрддрд░", "рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЕрдЪреНрдЫреА рдЬрд▓ рдирд┐рдХрд╛рд╕реА"],
                    "prevention": ["рдЬрд▓ рдирд┐рдХрд╛рд╕реА рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдП рд░рдЦреЗрдВ", "рдореМрд╕рдо рдХреА рдирд┐рдпрдорд┐рдд рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ"],
                    "next_steps": ["рд╕рд╛рдорд╛рдиреНрдп рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдВ рдЬрд╛рд░реА рд░рдЦреЗрдВ", "рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреЗ рд░рд╣реЗрдВ"]
                }
            }
        },
        "rainfall": {
            "en": {
                "why": "Rainfall prediction based on historical patterns and regional climate data.",
                "factors": ["Historical rainfall data", "Seasonal patterns", "Geographic location"],
                "prevention": ["Plan irrigation accordingly", "Prepare for excess/deficit"],
                "next_steps": ["Adjust crop selection", "Plan water storage", "Monitor updates"]
            },
            "hi": {
                "why": "рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдкреИрдЯрд░реНрди рдФрд░ рдХреНрд╖реЗрддреНрд░реАрдп рдЬрд▓рд╡рд╛рдпреБ рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд░реНрд╖рд╛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАред",
                "factors": ["рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╡рд░реНрд╖рд╛ рдбреЗрдЯрд╛", "рдореМрд╕рдореА рдкреИрдЯрд░реНрди", "рднреМрдЧреЛрд▓рд┐рдХ рд╕реНрдерд╛рди"],
                "prevention": ["рддрджрдиреБрд╕рд╛рд░ рд╕рд┐рдВрдЪрд╛рдИ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ", "рдЕрдзрд┐рдХ/рдХрдо рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд░рд╣реЗрдВ"],
                "next_steps": ["рдлрд╕рд▓ рдЪрдпрди рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ", "рдЬрд▓ рднрдВрдбрд╛рд░рдг рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ", "рдЕрдкрдбреЗрдЯ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ"]
            }
        },
        "yield": {
            "en": {
                "why": "Yield prediction based on crop type, area, season, and regional historical data.",
                "factors": ["Crop variety", "Area under cultivation", "Seasonal conditions", "Regional yield history"],
                "prevention": ["Use quality seeds", "Follow recommended practices", "Ensure timely irrigation"],
                "next_steps": ["Plan harvest logistics", "Explore market options", "Consider crop insurance"]
            },
            "hi": {
                "why": "рдлрд╕рд▓ рдкреНрд░рдХрд╛рд░, рдХреНрд╖реЗрддреНрд░, рдореМрд╕рдо рдФрд░ рдХреНрд╖реЗрддреНрд░реАрдп рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрдкрдЬ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАред",
                "factors": ["рдлрд╕рд▓ рдХреА рдХрд┐рд╕реНрдо", "рдЦреЗрддреА рдХрд╛ рдХреНрд╖реЗрддреНрд░", "рдореМрд╕рдореА рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпрд╛рдВ", "рдХреНрд╖реЗрддреНрд░реАрдп рдЙрдкрдЬ рдЗрддрд┐рд╣рд╛рд╕"],
                "prevention": ["рдЧреБрдгрд╡рддреНрддрд╛ рд╡рд╛рд▓реЗ рдмреАрдЬреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ", "рдЕрдиреБрд╢рдВрд╕рд┐рдд рдкреНрд░рдерд╛рдУрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ", "рд╕рдордп рдкрд░ рд╕рд┐рдВрдЪрд╛рдИ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ"],
                "next_steps": ["рдлрд╕рд▓ рдХрдЯрд╛рдИ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдХрд░реЗрдВ", "рдмрд╛рдЬрд╛рд░ рд╡рд┐рдХрд▓реНрдк рддрд▓рд╛рд╢реЗрдВ", "рдлрд╕рд▓ рдмреАрдорд╛ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"]
            }
        },
        "price": {
            "en": {
                "why": "Price prediction based on market trends, season, and historical data.",
                "factors": ["Historical price trends", "Seasonal demand", "Market conditions"],
                "prevention": ["Monitor market regularly", "Consider storage if prices low"],
                "next_steps": ["Plan selling strategy", "Check mandi prices", "Consider direct selling"]
            },
            "hi": {
                "why": "рдмрд╛рдЬрд╛рд░ рд░реБрдЭрд╛рди, рдореМрд╕рдо рдФрд░ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдореВрд▓реНрдп рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАред",
                "factors": ["рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдореВрд▓реНрдп рд░реБрдЭрд╛рди", "рдореМрд╕рдореА рдорд╛рдВрдЧ", "рдмрд╛рдЬрд╛рд░ рдХреА рд╕реНрдерд┐рддрд┐"],
                "prevention": ["рдмрд╛рдЬрд╛рд░ рдХреА рдирд┐рдпрдорд┐рдд рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ", "рдХрдо рдХреАрдорддреЛрдВ рдкрд░ рднрдВрдбрд╛рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"],
                "next_steps": ["рдмрд┐рдХреНрд░реА рд░рдгрдиреАрддрд┐ рдмрдирд╛рдПрдВ", "рдордВрдбреА рдХреА рдХреАрдорддреЗрдВ рдЬрд╛рдВрдЪреЗрдВ", "рд╕реАрдзреА рдмрд┐рдХреНрд░реА рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"]
            }
        },
        "profit": {
            "en": {
                "why": "Profit calculated based on expected yield, market price, and input costs.",
                "factors": ["Area under cultivation", "Expected yield", "Input costs", "Market price"],
                "prevention": ["Optimize input usage", "Reduce wastage", "Negotiate better prices"],
                "next_steps": ["Track expenses carefully", "Explore value addition", "Consider cooperative selling"]
            },
            "hi": {
                "why": "рдЕрдкреЗрдХреНрд╖рд┐рдд рдЙрдкрдЬ, рдмрд╛рдЬрд╛рд░ рдореВрд▓реНрдп рдФрд░ рдЗрдирдкреБрдЯ рд▓рд╛рдЧрдд рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓рд╛рдн рдХреА рдЧрдгрдирд╛ред",
                "factors": ["рдЦреЗрддреА рдХрд╛ рдХреНрд╖реЗрддреНрд░", "рдЕрдкреЗрдХреНрд╖рд┐рдд рдЙрдкрдЬ", "рдЗрдирдкреБрдЯ рд▓рд╛рдЧрдд", "рдмрд╛рдЬрд╛рд░ рдореВрд▓реНрдп"],
                "prevention": ["рдЗрдирдкреБрдЯ рдЙрдкрдпреЛрдЧ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░реЗрдВ", "рдмрд░реНрдмрд╛рджреА рдХрдо рдХрд░реЗрдВ", "рдмреЗрд╣рддрд░ рдХреАрдорддреЛрдВ рдХреЗ рд▓рд┐рдП рдмрд╛рддрдЪреАрдд рдХрд░реЗрдВ"],
                "next_steps": ["рдЦрд░реНрдЪреЛрдВ рдХреЛ рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рдЯреНрд░реИрдХ рдХрд░реЗрдВ", "рдореВрд▓реНрдп рд╕рдВрд╡рд░реНрдзрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ", "рд╕рд╣рдХрд╛рд░реА рдмрд┐рдХреНрд░реА рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"]
            }
        },
        "storm": {
            "en": {
                "high": {
                    "why": "High storm risk based on atmospheric conditions.",
                    "factors": ["Low pressure system", "High wind speeds", "Humidity levels"],
                    "prevention": ["Secure loose items", "Harvest vulnerable crops", "Strengthen structures"],
                    "next_steps": ["Stay indoors during storm", "Have emergency kit ready", "Keep communication devices charged"]
                },
                "low": {
                    "why": "Low storm risk. Conditions are stable.",
                    "factors": ["Stable atmospheric pressure", "Normal wind patterns"],
                    "prevention": ["Stay updated on weather", "Regular monitoring"],
                    "next_steps": ["Continue normal activities", "Keep prepared anyway"]
                }
            },
            "hi": {
                "high": {
                    "why": "рд╡рд╛рдпреБрдордВрдбрд▓реАрдп рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрдЪреНрдЪ рддреВрдлрд╛рди рдЬреЛрдЦрд┐рдоред",
                    "factors": ["рдирд┐рдореНрди рджрдмрд╛рд╡ рдкреНрд░рдгрд╛рд▓реА", "рддреЗрдЬ рд╣рд╡рд╛ рдХреА рдЧрддрд┐", "рдЖрд░реНрджреНрд░рддрд╛ рд╕реНрддрд░"],
                    "prevention": ["рдвреАрд▓реА рдЪреАрдЬреЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░реЗрдВ", "рдХрдордЬреЛрд░ рдлрд╕рд▓реЛрдВ рдХреА рдХрдЯрд╛рдИ рдХрд░реЗрдВ", "рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЛ рдордЬрдмреВрдд рдХрд░реЗрдВ"],
                    "next_steps": ["рддреВрдлрд╛рди рдХреЗ рджреМрд░рд╛рди рдШрд░ рдХреЗ рдЕрдВрджрд░ рд░рд╣реЗрдВ", "рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдХрд┐рдЯ рддреИрдпрд╛рд░ рд░рдЦреЗрдВ", "рд╕рдВрдЪрд╛рд░ рдЙрдкрдХрд░рдг рдЪрд╛рд░реНрдЬ рд░рдЦреЗрдВ"]
                },
                "low": {
                    "why": "рддреВрдлрд╛рди рдХрд╛ рдЬреЛрдЦрд┐рдо рдХрдо рд╣реИред рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпрд╛рдВ рд╕реНрдерд┐рд░ рд╣реИрдВред",
                    "factors": ["рд╕реНрдерд┐рд░ рд╡рд╛рдпреБрдордВрдбрд▓реАрдп рджрдмрд╛рд╡", "рд╕рд╛рдорд╛рдиреНрдп рд╣рд╡рд╛ рдкреИрдЯрд░реНрди"],
                    "prevention": ["рдореМрд╕рдо рдкрд░ рдЕрдкрдбреЗрдЯ рд░рд╣реЗрдВ", "рдирд┐рдпрдорд┐рдд рдирд┐рдЧрд░рд╛рдиреА"],
                    "next_steps": ["рд╕рд╛рдорд╛рдиреНрдп рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдВ рдЬрд╛рд░реА рд░рдЦреЗрдВ", "рдлрд┐рд░ рднреА рддреИрдпрд╛рд░ рд░рд╣реЗрдВ"]
                }
            }
        },
        "water": {
            "en": {
                "why": "Water requirement calculated based on crop type, growth stage, and weather.",
                "factors": ["Crop water needs", "Growth stage", "Temperature", "Soil type"],
                "prevention": ["Install efficient irrigation", "Mulch to reduce evaporation"],
                "next_steps": ["Schedule irrigation", "Monitor soil moisture", "Check water quality"]
            },
            "hi": {
                "why": "рдлрд╕рд▓ рдкреНрд░рдХрд╛рд░, рд╡рд┐рдХрд╛рд╕ рдЪрд░рдг рдФрд░ рдореМрд╕рдо рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд╛рдиреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ред",
                "factors": ["рдлрд╕рд▓ рдХреА рдкрд╛рдиреА рдХреА рдЬрд░реВрд░рдд", "рд╡рд┐рдХрд╛рд╕ рдЪрд░рдг", "рддрд╛рдкрдорд╛рди", "рдорд┐рдЯреНрдЯреА рдХрд╛ рдкреНрд░рдХрд╛рд░"],
                "prevention": ["рдХреБрд╢рд▓ рд╕рд┐рдВрдЪрд╛рдИ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ", "рд╡рд╛рд╖реНрдкреАрдХрд░рдг рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд▓реНрдЪ рдХрд░реЗрдВ"],
                "next_steps": ["рд╕рд┐рдВрдЪрд╛рдИ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ", "рдорд┐рдЯреНрдЯреА рдХреА рдирдореА рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ", "рдкрд╛рдиреА рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдЬрд╛рдВрдЪреЗрдВ"]
            }
        },
        "soil_health": {
            "en": {
                "good": {
                    "why": "Soil health is good based on nutrient analysis.",
                    "factors": ["Balanced NPK levels", "Optimal pH", "Good organic content"],
                    "prevention": ["Maintain organic matter", "Practice crop rotation"],
                    "next_steps": ["Continue current practices", "Regular testing"]
                },
                "moderate": {
                    "why": "Soil health is moderate. Some improvements needed.",
                    "factors": ["Some nutrient deficiency", "pH slightly off"],
                    "prevention": ["Add recommended fertilizers", "Increase organic content"],
                    "next_steps": ["Apply corrective measures", "Retest in 3 months"]
                },
                "poor": {
                    "why": "Soil health is poor. Immediate attention needed.",
                    "factors": ["Severe nutrient deficiency", "pH imbalance", "Low organic matter"],
                    "prevention": ["Major soil amendment required", "Consider cover crops"],
                    "next_steps": ["Consult soil expert", "Apply organic matter", "Consider fallow period"]
                }
            },
            "hi": {
                "good": {
                    "why": "рдкреЛрд╖рдХ рддрддреНрд╡ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдорд┐рдЯреНрдЯреА рдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЕрдЪреНрдЫрд╛ рд╣реИред",
                    "factors": ["рд╕рдВрддреБрд▓рд┐рдд NPK рд╕реНрддрд░", "рдЗрд╖реНрдЯрддрдо pH", "рдЕрдЪреНрдЫреА рдЬреИрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА"],
                    "prevention": ["рдЬреИрд╡рд┐рдХ рдкрджрд╛рд░реНрде рдмрдирд╛рдП рд░рдЦреЗрдВ", "рдлрд╕рд▓ рдЪрдХреНрд░ рдЕрдкрдирд╛рдПрдВ"],
                    "next_steps": ["рд╡рд░реНрддрдорд╛рди рдкреНрд░рдерд╛рдПрдВ рдЬрд╛рд░реА рд░рдЦреЗрдВ", "рдирд┐рдпрдорд┐рдд рдкрд░реАрдХреНрд╖рдг"]
                },
                "moderate": {
                    "why": "рдорд┐рдЯреНрдЯреА рдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдордзреНрдпрдо рд╣реИред рдХреБрдЫ рд╕реБрдзрд╛рд░ рдХреА рдЬрд░реВрд░рдд рд╣реИред",
                    "factors": ["рдХреБрдЫ рдкреЛрд╖рдХ рддрддреНрд╡реЛрдВ рдХреА рдХрдореА", "pH рдереЛрдбрд╝рд╛ рдЕрд╕рдВрддреБрд▓рд┐рдд"],
                    "prevention": ["рдЕрдиреБрд╢рдВрд╕рд┐рдд рдЙрд░реНрд╡рд░рдХ рдбрд╛рд▓реЗрдВ", "рдЬреИрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА рдмрдврд╝рд╛рдПрдВ"],
                    "next_steps": ["рд╕реБрдзрд╛рд░рд╛рддреНрдордХ рдЙрдкрд╛рдп рд▓рд╛рдЧреВ рдХрд░реЗрдВ", "3 рдорд╣реАрдиреЗ рдореЗрдВ рдлрд┐рд░ рдЬрд╛рдВрдЪ рдХрд░реЗрдВ"]
                },
                "poor": {
                    "why": "рдорд┐рдЯреНрдЯреА рдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЦрд░рд╛рдм рд╣реИред рддрддреНрдХрд╛рд▓ рдзреНрдпрд╛рди рджреЗрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред",
                    "factors": ["рдЧрдВрднреАрд░ рдкреЛрд╖рдХ рддрддреНрд╡реЛрдВ рдХреА рдХрдореА", "pH рдЕрд╕рдВрддреБрд▓рди", "рдХрдо рдЬреИрд╡рд┐рдХ рдкрджрд╛рд░реНрде"],
                    "prevention": ["рдкреНрд░рдореБрдЦ рдорд┐рдЯреНрдЯреА рд╕рдВрд╢реЛрдзрди рдЖрд╡рд╢реНрдпрдХ", "рдХрд╡рд░ рдлрд╕рд▓реЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"],
                    "next_steps": ["рдорд┐рдЯреНрдЯреА рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ рд▓реЗрдВ", "рдЬреИрд╡рд┐рдХ рдкрджрд╛рд░реНрде рдбрд╛рд▓реЗрдВ", "рдкрд░рддреА рдЕрд╡рдзрд┐ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"]
                }
            }
        },
        "co2": {
            "en": {
                "why": "CO2 levels predicted based on temporal patterns and trends.",
                "factors": ["Historical data", "Seasonal variations", "Global trends"],
                "prevention": ["Plant more trees", "Reduce emissions"],
                "next_steps": ["Monitor local air quality", "Consider carbon farming"]
            },
            "hi": {
                "why": "рд╕рд╛рдордпрд┐рдХ рдкреИрдЯрд░реНрди рдФрд░ рд░реБрдЭрд╛рдиреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ CO2 рд╕реНрддрд░ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАред",
                "factors": ["рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдбреЗрдЯрд╛", "рдореМрд╕рдореА рдмрджрд▓рд╛рд╡", "рд╡реИрд╢реНрд╡рд┐рдХ рд░реБрдЭрд╛рди"],
                "prevention": ["рдЕрдзрд┐рдХ рдкреЗрдбрд╝ рд▓рдЧрд╛рдПрдВ", "рдЙрддреНрд╕рд░реНрдЬрди рдХрдо рдХрд░реЗрдВ"],
                "next_steps": ["рд╕реНрдерд╛рдиреАрдп рд╡рд╛рдпреБ рдЧреБрдгрд╡рддреНрддрд╛ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ", "рдХрд╛рд░реНрдмрди рдЦреЗрддреА рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ"]
            }
        },
        "ndvi": {
            "en": {
                "high": {
                    "why": "High NDVI indicates healthy, dense vegetation.",
                    "factors": ["Good chlorophyll content", "Healthy plant growth", "Adequate water"],
                    "prevention": ["Maintain current practices", "Regular monitoring"],
                    "next_steps": ["Continue irrigation schedule", "Plan for harvest"]
                },
                "moderate": {
                    "why": "Moderate NDVI indicates some stress in vegetation.",
                    "factors": ["Some water stress", "Possible nutrient deficiency"],
                    "prevention": ["Check irrigation", "Apply fertilizers if needed"],
                    "next_steps": ["Investigate cause", "Adjust care routine"]
                },
                "low": {
                    "why": "Low NDVI indicates stressed or sparse vegetation.",
                    "factors": ["Water stress", "Nutrient deficiency", "Possible disease"],
                    "prevention": ["Immediate irrigation", "Soil testing", "Disease check"],
                    "next_steps": ["Urgent intervention needed", "Consult expert"]
                }
            },
            "hi": {
                "high": {
                    "why": "рдЙрдЪреНрдЪ NDVI рд╕реНрд╡рд╕реНрде, рдШрдиреА рд╡рдирд╕реНрдкрддрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред",
                    "factors": ["рдЕрдЪреНрдЫреА рдХреНрд▓реЛрд░реЛрдлрд┐рд▓ рд╕рд╛рдордЧреНрд░реА", "рд╕реНрд╡рд╕реНрде рдкреМрдзреЗ рдХреА рд╡реГрджреНрдзрд┐", "рдкрд░реНрдпрд╛рдкреНрдд рдкрд╛рдиреА"],
                    "prevention": ["рд╡рд░реНрддрдорд╛рди рдкреНрд░рдерд╛рдПрдВ рдмрдирд╛рдП рд░рдЦреЗрдВ", "рдирд┐рдпрдорд┐рдд рдирд┐рдЧрд░рд╛рдиреА"],
                    "next_steps": ["рд╕рд┐рдВрдЪрд╛рдИ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЬрд╛рд░реА рд░рдЦреЗрдВ", "рдлрд╕рд▓ рдХрдЯрд╛рдИ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ"]
                },
                "moderate": {
                    "why": "рдордзреНрдпрдо NDVI рд╡рдирд╕реНрдкрддрд┐ рдореЗрдВ рдХреБрдЫ рддрдирд╛рд╡ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред",
                    "factors": ["рдХреБрдЫ рдкрд╛рдиреА рдХрд╛ рддрдирд╛рд╡", "рд╕рдВрднрд╛рд╡рд┐рдд рдкреЛрд╖рдХ рддрддреНрд╡реЛрдВ рдХреА рдХрдореА"],
                    "prevention": ["рд╕рд┐рдВрдЪрд╛рдИ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ", "рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ рдЙрд░реНрд╡рд░рдХ рдбрд╛рд▓реЗрдВ"],
                    "next_steps": ["рдХрд╛рд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ", "рджреЗрдЦрднрд╛рд▓ рджрд┐рдирдЪрд░реНрдпрд╛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ"]
                },
                "low": {
                    "why": "рдХрдо NDVI рддрдирд╛рд╡рдЧреНрд░рд╕реНрдд рдпрд╛ рд╡рд┐рд░рд▓ рд╡рдирд╕реНрдкрддрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред",
                    "factors": ["рдкрд╛рдиреА рдХрд╛ рддрдирд╛рд╡", "рдкреЛрд╖рдХ рддрддреНрд╡реЛрдВ рдХреА рдХрдореА", "рд╕рдВрднрд╛рд╡рд┐рдд рдмреАрдорд╛рд░реА"],
                    "prevention": ["рддрддреНрдХрд╛рд▓ рд╕рд┐рдВрдЪрд╛рдИ", "рдорд┐рдЯреНрдЯреА рдкрд░реАрдХреНрд╖рдг", "рд░реЛрдЧ рдЬрд╛рдВрдЪ"],
                    "next_steps": ["рддрддреНрдХрд╛рд▓ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдЖрд╡рд╢реНрдпрдХ", "рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ рд▓реЗрдВ"]
                }
            }
        }
    }
    
    @staticmethod
    def _normalize_prediction(prediction: str) -> str:
        if not prediction:
            return "disease"

        p = str(prediction).strip().lower()

        if p in ["healthy", "health", "normal"]:
            return "healthy"

        if p in [
            "disease",
            "diseased",
            "early",
            "early stage",
            "early_stage",
            "early-stage",
            "initial",
            "initial stage",
        ]:
            return "disease"

        # For keys like high / moderate / low (AQI, NDVI, flood, etc.)
        return p

    # --------------------------------------------------
    # ЁЯФН MAIN EXPLANATION RESOLVER (FIXED)
    # --------------------------------------------------
    @classmethod
    def get_explanation(
        cls,
        model_type: str,
        prediction: str,
        language: Language = Language.EN
    ) -> ExplanationResponse:
        """
        Robust, language-safe explanation resolver
        """

        # 1я╕ПтГг Language key
        lang = language.value if language else "en"

        # 2я╕ПтГг Normalize prediction
        key = cls._normalize_prediction(prediction)

        # 3я╕ПтГг Get model block
        model_block = cls.EXPLANATIONS.get(model_type)
        if not model_block:
            return cls._default_explanation(language)

        # 4я╕ПтГг Get STRICT language block (no mixing)
        lang_block = model_block.get(lang)
        if not lang_block:
            lang_block = model_block.get("en", {})

        # 5я╕ПтГг Get explanation
        explanation = None
        if isinstance(lang_block, dict):
            explanation = lang_block.get(key)

        # 6я╕ПтГг Final same-language fallback
        if not explanation:
            explanation = {
                "why": (
                    "рдкрд░рд┐рдгрд╛рдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЧрдпрд╛ред"
                    if lang == "hi"
                    else "Prediction generated based on analysis."
                ),
                "factors": [],
                "prevention": [],
                "next_steps": []
            }

        return ExplanationResponse(
            why=explanation.get("why", ""),
            factors=explanation.get("factors", []),
            prevention=explanation.get("prevention", []),
            next_steps=explanation.get("next_steps", [])
        )

    # --------------------------------------------------
    # ЁЯФБ DEFAULT FALLBACK (LANGUAGE SAFE)
    # --------------------------------------------------
    @staticmethod
    def _default_explanation(language: Language) -> ExplanationResponse:
        if language == Language.HI:
            return ExplanationResponse(
                why="рдЙрдкрд▓рдмреНрдз рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд░рд┐рдгрд╛рдо рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЧрдпрд╛ред",
                factors=[],
                prevention=[],
                next_steps=[]
            )

        return ExplanationResponse(
            why="Prediction generated based on available information.",
            factors=[],
            prevention=[],
            next_steps=[]
        )


# тЬЕ SINGLETON INSTANCE
explainer = Explainer()